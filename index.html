<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sofia - Agente de IA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            width: 350px;
            height: 600px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            position: relative;
        }

        .header {
            background: white;
            padding: 20px 20px 10px 20px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .logo {
            width: 120px;
            height: 40px;
            margin: 0 auto 20px;
            background: linear-gradient(45deg, #4a90e2, #7ed321);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }

        .avatar-container {
            position: relative;
            margin: 0 auto;
            transition: all 0.3s ease;
        }

        .avatar-container.chat-mode {
            width: 80px;
            height: 80px;
        }

        .avatar-container.voice-mode {
            width: 120px;
            height: 120px;
            margin: 40px auto;
        }

        .avatar {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #4a90e2;
            transition: all 0.3s ease;
        }

        .sound-waves {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .sound-waves.active {
            opacity: 1;
        }

        .wave {
            position: absolute;
            border: 2px solid #4a90e2;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .wave:nth-child(1) {
            width: 140px;
            height: 140px;
            top: -70px;
            left: -70px;
            animation-delay: 0s;
        }

        .wave:nth-child(2) {
            width: 180px;
            height: 180px;
            top: -90px;
            left: -90px;
            animation-delay: 0.5s;
        }

        .wave:nth-child(3) {
            width: 220px;
            height: 220px;
            top: -110px;
            left: -110px;
            animation-delay: 1s;
        }

        @keyframes pulse {
            0% {
                transform: scale(0.8);
                opacity: 1;
            }
            100% {
                transform: scale(1.2);
                opacity: 0;
            }
        }

        .agent-name {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin: 15px 0 5px;
        }

        .agent-title {
            font-size: 16px;
            color: #666;
            margin-bottom: 10px;
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: calc(100% - 160px - 80px - 70px); /* Header más compacto */
        }

        .chat-panel {
            flex: 1;
            padding: 15px 20px 0 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            opacity: 1;
            transition: opacity 0.3s ease;
        }

        .chat-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 12px 20px;
            background: #fafbfc;
            border-top: 1px solid #eee;
            border-bottom: 1px solid #eee;
            position: absolute;
            bottom: 150px;
            left: 0;
            right: 0;
            z-index: 98;
        }

        .chat-tag {
            background: #f5f6f7;
            color: #6c757d;
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #e9ecef;
            white-space: nowrap;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        .chat-tag:hover {
            background: #e9ecef;
            color: #495057;
            border-color: #dee2e6;
        }

        .chat-tag:active {
            transform: scale(0.98);
        }

        .chat-panel.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .voice-panel {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .voice-panel.active {
            opacity: 1;
            pointer-events: auto;
        }

        .chat-input {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px 20px;
            background: white;
            border-top: 1px solid #eee;
            position: absolute;
            bottom: 80px;
            left: 0;
            right: 0;
            z-index: 99;
        }

        .input-field {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 25px;
            outline: none;
            font-size: 14px;
        }

        .send-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: #7b2cbf;
            color: white;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.1s ease;
        }

        .send-btn:hover {
            transform: scale(1.1);
        }

        .send-btn:active {
            transform: scale(0.95);
        }

        .bottom-nav {
            display: flex;
            background: white;
            border-top: 1px solid #eee;
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 80px;
            z-index: 100;
        }

        .nav-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background: white;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all 0.2s ease;
            position: relative;
            border-radius: 0;
        }

        .nav-btn.active {
            background: #4a90e2;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
        }

        .nav-btn:not(.active) {
            color: #888;
            background: #f8f9fa;
        }

        .nav-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .nav-btn:active {
            transform: translateY(0px);
        }

        .nav-icon {
            width: 28px;
            height: 28px;
            transition: all 0.2s ease;
            stroke-width: 2.5;
        }

        .nav-btn.active .nav-icon {
            transform: scale(1.1);
            filter: drop-shadow(0 2px 4px rgba(255,255,255,0.3));
        }

        .nav-label {
            font-size: 13px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px 0 20px 0;
            margin-bottom: 0;
        }

        .message {
            margin: 10px 0;
            padding: 10px 15px;
            border-radius: 18px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .message.bot {
            background: #f0f0f0;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }

        .message.user {
            background: #4a90e2;
            color: white;
            align-self: flex-end;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }

        .recording-indicator {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-top: 20px;
        }

        .recording-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #e74c3c;
            border-radius: 50%;
            margin-right: 8px;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">Global Exchange</div>
            <div class="avatar-container chat-mode" id="avatarContainer">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 120 120'%3E%3Ccircle cx='60' cy='60' r='60' fill='%23f0f0f0'/%3E%3Ccircle cx='60' cy='45' r='20' fill='%234a90e2'/%3E%3Cpath d='M30 90 Q30 70 60 70 Q90 70 90 90 Z' fill='%234a90e2'/%3E%3C/svg%3E" alt="Sofia" class="avatar" id="avatar">
                <div class="sound-waves" id="soundWaves">
                    <div class="wave"></div>
                    <div class="wave"></div>
                    <div class="wave"></div>
                </div>
            </div>
            <div class="agent-name">Sofia</div>
            <div class="agent-title">Agente de IA</div>
        </div>

        <div class="content">
            <div class="chat-panel" id="chatPanel">
                <div class="chat-messages" id="chatMessages">
                    <div class="message bot">
                        ¡Hola! Soy Sofia, tu asistente de IA. ¿En qué puedo ayudarte hoy?
                    </div>
                </div>
                <div class="chat-tags">
                    <button class="chat-tag" onclick="selectTag('Ver fotos')">Ver fotos</button>
                    <button class="chat-tag" onclick="selectTag('Ver videos')">Ver videos</button>
                    <button class="chat-tag" onclick="selectTag('Preguntas frecuentes')">Preguntas frecuentes</button>
                </div>
                <div class="chat-input">
                    <input type="text" class="input-field" placeholder="Escriba aquí..." id="messageInput">
                    <button class="send-btn" id="sendBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M22 2L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="voice-panel" id="voicePanel">
                <div class="recording-indicator" id="recordingIndicator">
                    <div class="recording-dot"></div>
                    Toca para hablar...
                </div>
            </div>
        </div>

        <div class="bottom-nav">
            <button class="nav-btn active" id="chatBtn">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 11.5C21.0034 12.8199 20.6951 14.1219 20.1 15.3C19.3944 16.7118 18.3098 17.8992 16.9674 18.7293C15.6251 19.5594 14.0782 19.9994 12.5 20C11.1801 20.0035 9.87812 19.6951 8.7 19.1L3 21L4.9 15.3C4.30493 14.1219 3.99656 12.8199 4 11.5C4.00061 9.92179 4.44061 8.37488 5.27072 7.03258C6.10083 5.69028 7.28825 4.6056 8.7 3.90003C9.87812 3.30496 11.1801 2.99659 12.5 3.00003H13C15.0843 3.11502 17.053 3.99479 18.5291 5.47086C20.0052 6.94694 20.885 8.91568 21 11V11.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="nav-label">Chat</span>
            </button>
            <button class="nav-btn" id="voiceBtn">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2C13.1046 2 14 2.89543 14 4V12C14 13.1046 13.1046 14 12 14C10.8954 14 10 13.1046 10 12V4C10 2.89543 10.8954 2 12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M19 10V12C19 15.866 15.866 19 12 19C8.13401 19 5 15.866 5 12V10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 19V23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M8 23H16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="nav-label">Voice</span>
            </button>
        </div>
    </div>

    <script>
        const chatBtn = document.getElementById('chatBtn');
        const voiceBtn = document.getElementById('voiceBtn');
        const chatPanel = document.getElementById('chatPanel');
        const voicePanel = document.getElementById('voicePanel');
        const avatarContainer = document.getElementById('avatarContainer');
        const soundWaves = document.getElementById('soundWaves');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const chatMessages = document.getElementById('chatMessages');
        const recordingIndicator = document.getElementById('recordingIndicator');

        let isVoiceMode = false;
        let isRecording = false;

        // Cambiar entre modos
        function switchMode(mode) {
            if (mode === 'chat') {
                isVoiceMode = false;
                chatBtn.classList.add('active');
                voiceBtn.classList.remove('active');
                chatPanel.classList.remove('hidden');
                voicePanel.classList.remove('active');
                avatarContainer.classList.remove('voice-mode');
                avatarContainer.classList.add('chat-mode');
                soundWaves.classList.remove('active');
            } else if (mode === 'voice') {
                isVoiceMode = true;
                voiceBtn.classList.add('active');
                chatBtn.classList.remove('active');
                chatPanel.classList.add('hidden');
                voicePanel.classList.add('active');
                avatarContainer.classList.remove('chat-mode');
                avatarContainer.classList.add('voice-mode');
                soundWaves.classList.add('active');
            }
        }

        // Event listeners para los botones de navegación
        chatBtn.addEventListener('click', () => {
            switchMode('chat');
        });

        voiceBtn.addEventListener('click', () => {
            switchMode('voice');
        });

        // Funcionalidad del chat
        function addMessage(text, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message');
            messageDiv.classList.add(isUser ? 'user' : 'bot');
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            
            // Auto-scroll hacia abajo siempre que se agrega un nuevo mensaje
            setTimeout(() => {
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 10);
        }

        function sendMessage() {
            const message = messageInput.value.trim();
            if (message) {
                addMessage(message, true);
                messageInput.value = '';
                
                // Simular respuesta del bot
                setTimeout(() => {
                    const responses = [
                        "Entiendo tu consulta. ¿Puedes darme más detalles?",
                        "Perfecto, estoy procesando tu solicitud.",
                        "Gracias por la información. Te ayudo con eso.",
                        "Interesante pregunta. Déjame ayudarte con eso.",
                        "Claro, puedo asistirte con eso.",
                        "He recibido tu mensaje. Aquí tienes algunas opciones que podrían interesarte para continuar con tu consulta sobre productos.",
                        "Excelente pregunta. Te proporciono información detallada que espero te sea muy útil para resolver tu consulta de manera completa."
                    ];
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    addMessage(randomResponse);
                }, 1000);
            }
        }

        sendBtn.addEventListener('click', sendMessage);

        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Funcionalidad para los tags
        function selectTag(tagText) {
            messageInput.value = tagText;
            messageInput.focus();
        }

        // Detectar scroll manual del usuario
        let isUserScrolling = false;
        let scrollTimeout;

        chatMessages.addEventListener('scroll', () => {
            // Detectar si el usuario está haciendo scroll manualmente
            const isAtBottom = chatMessages.scrollHeight - chatMessages.clientHeight <= chatMessages.scrollTop + 1;
            
            if (!isAtBottom) {
                isUserScrolling = true;
                
                // Reset el flag después de un tiempo sin scroll
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    // Si está cerca del final, resetear para auto-scroll en próximos mensajes
                    if (chatMessages.scrollHeight - chatMessages.clientHeight <= chatMessages.scrollTop + 50) {
                        isUserScrolling = false;
                    }
                }, 1000);
            } else {
                isUserScrolling = false;
            }
        });

        // Modificar la función addMessage para respetar el scroll del usuario
        function addMessage(text, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message');
            messageDiv.classList.add(isUser ? 'user' : 'bot');
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            
            // Solo hacer auto-scroll si el usuario no está navegando mensajes anteriores
            if (!isUserScrolling) {
                setTimeout(() => {
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 10);
            }
        }
        voicePanel.addEventListener('click', () => {
            if (isVoiceMode && !isRecording) {
                startRecording();
            }
        });

        function startRecording() {
            isRecording = true;
            recordingIndicator.innerHTML = '<div class="recording-dot"></div>Grabando... Toca para detener';
            
            // Simular grabación
            setTimeout(() => {
                stopRecording();
            }, 3000);
        }

        function stopRecording() {
            isRecording = false;
            recordingIndicator.innerHTML = '<div class="recording-dot"></div>Procesando...';
            
            setTimeout(() => {
                recordingIndicator.innerHTML = '<div class="recording-dot"></div>Toca para hablar...';
                // Aquí podrías agregar la respuesta por voz
            }, 2000);
        }

        // Inicializar en modo chat
        switchMode('chat');
    </script>
</body>
</html>